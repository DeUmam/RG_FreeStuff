local pexConverter=require"scripts.pexConverter";local function pdAltLoader(group,x,y,name,params)print(group,x,y,name,params);local params=params or{};local width=params.width or 200;local height=params.height or width;local scale=params.scale or 1;local ex=params.ex or 0;local ey=params.ey or 0;local imageRoot=params.imageRoot or"";local altTexture=params.altTexture;local sample=display.newContainer(group,width,height);sample.x=x;sample.y=y;local tmp=display.newRect(sample,0,0,width,height);tmp.x=0;tmp.y=0;tmp:setFillColor(0,0,0,0);tmp:setStrokeColor(1,1,0,1);tmp.strokeWidth=4;
print("Loading particle data file: "..imageRoot..name..".pex");local data=pexConverter(imageRoot..name..".pex");if(altTexture)then data.textureFileName=altTexture;end data.textureFileName=imageRoot..data.textureFileName;
for k,v in pairs(data)do data[k]=tonumber(v)or v;end data.gravityx=data.gravityx or 0;data.gravityy=data.gravityy or 0;data.minRadiusVariance=data.minRadiusVariance or 0;data.sourcePositionVariancex=data.sourcePositionVariancex or 0;data.sourcePositionVariancey=data.sourcePositionVariancey or 0;data.yCoordFlipped=data.yCoordFlipped or 1;data.maxParticles=round(data.maxParticles or 100,0);data.particleLifespan=tonumber(data.particleLifespan)or 1.0;
local emitter=display.newEmitter(data);emitter.x=ex;emitter.y=ey;sample:insert(emitter);return sample;end return pdAltLoader